---
title: Przywracanie pakietu NuGet | Dokumentacja firmy Microsoft
author: kraigb
ms.author: kraigb
manager: ghogen
ms.date: 02/12/2018
ms.topic: article
ms.prod: nuget
ms.technology: 
ms.assetid: a7bf21da-86ae-4c2d-8750-04ff53f41967
description: "Przegląd sposobu NuGet przywraca pakietów, od których jest zależna projektu, w tym jak wyłączyć przywracania i ograniczyć wersji."
keywords: "Przywracanie pakietu NuGet, instalacja pakietu NuGet, instalowanie pakietu Przywracanie pakietów, wersje zależności, wyłączenie automatycznego przywracania ograniczający wersji pakietu"
ms.reviewer:
- karann-msft
- unniravindranathan
ms.openlocfilehash: 1980e00f865344927d105513f62923d14971b17b
ms.sourcegitcommit: 7969f6cd94eccfee5b62031bb404422139ccc383
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/20/2018
---
# <a name="package-restore"></a><span data-ttu-id="cb364-104">Przywracanie pakietu</span><span class="sxs-lookup"><span data-stu-id="cb364-104">Package Restore</span></span>

<span data-ttu-id="cb364-105">Aby promować czyszczący Środowisko deweloperskie i zmniejszyć rozmiar repozytorium NuGet **przywracania pakietów** instaluje pakiety wszystkich przywoływanych przed projektu jest wbudowana.</span><span class="sxs-lookup"><span data-stu-id="cb364-105">To promote a cleaner development environment and to reduce repository size, NuGet **Package Restore** installs all referenced packages before a project is built.</span></span> <span data-ttu-id="cb364-106">Ta funkcja powszechnie używane&mdash;dostępne w Visual Studio .NET Core 2.0 + i xbuild na Mono&mdash;zapewnia, że wszystkie zależności są dostępne w projekcie bez konieczności pakiety mają być przechowywane w kontroli źródła (zobacz [ Pakiety i kontroli źródła](../consume-packages/packages-and-source-control.md) na temat konfigurowania repozytorium, aby wykluczyć pliki binarne pakietu).</span><span class="sxs-lookup"><span data-stu-id="cb364-106">This widely-used feature&mdash;available in Visual Studio, .NET Core 2.0+, and xbuild on Mono&mdash;ensures that all dependencies are available in a project without requiring those packages to be stored in source control (see [Packages and Source Control](../consume-packages/packages-and-source-control.md) on how to configure your repository to exclude package binaries).</span></span> <span data-ttu-id="cb364-107">Można też ręcznie przywrócić pakiety w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="cb364-107">You can also manually restore packages at any time.</span></span>

<span data-ttu-id="cb364-108">Aby uzyskać dodatkowe szczegóły dotyczące przywracania pakietu na serwerach kompilacji, zobacz [Przywracanie pakietu z TFBuild](../consume-packages/team-foundation-build.md).</span><span class="sxs-lookup"><span data-stu-id="cb364-108">For additional details on package restore on build servers, see [Package restore with TFBuild](../consume-packages/team-foundation-build.md).</span></span>

## <a name="package-restore-overview"></a><span data-ttu-id="cb364-109">Omówienie przywracania pakietu</span><span class="sxs-lookup"><span data-stu-id="cb364-109">Package restore overview</span></span>

<span data-ttu-id="cb364-110">Najpierw Przywracanie pakietów instaluje bezpośrednich zależności projektu, zgodnie z potrzebami, następnie zainstalować wszelkie zależności tych pakietów w całym na wykresie zależności całego.</span><span class="sxs-lookup"><span data-stu-id="cb364-110">Restoring packages first installs the direct dependencies of a project as needed, then installing any dependencies of those packages throughout the entire dependency graph.</span></span>

<span data-ttu-id="cb364-111">Jeśli pakiet nie jest już zainstalowany, NuGet najpierw próbuje pobrać go z [pamięci podręcznej](../consume-packages/managing-the-nuget-cache.md).</span><span class="sxs-lookup"><span data-stu-id="cb364-111">If a package is not already installed, NuGet first attempts to retrieve it from the [cache](../consume-packages/managing-the-nuget-cache.md).</span></span> <span data-ttu-id="cb364-112">Jeśli pakiet nie jest w pamięci podręcznej, NuGet podejmuje próbę pobrania (i pamięci podręcznej) pakiet ze wszystkich włączonych źródeł (zobacz [NuGet Konfigurowanie zachowania](Configuring-NuGet-Behavior.md)); źródła są również wyświetlane w **Narzędzia > Opcje > Pakiet NuGet Menedżer > źródła pakietów** listy w programie Visual Studio).</span><span class="sxs-lookup"><span data-stu-id="cb364-112">If the package is not in the cache, NuGet then attempts to download (and cache) the package from all enabled sources (see [Configuring NuGet behavior](Configuring-NuGet-Behavior.md)); sources also appear in the  **Tools > Options > NuGet Package Manager > Package Sources** list in Visual Studio).</span></span> <span data-ttu-id="cb364-113">NuGet ignoruje kolejność źródeł pakietów przy użyciu pakietu z dowolną wskazaną źródło jest najpierw odpowiadać na żądania.</span><span class="sxs-lookup"><span data-stu-id="cb364-113">NuGet ignores the order of package sources, using the package from whichever source is first to respond to requests.</span></span>

> [!Note]
> <span data-ttu-id="cb364-114">NuGet nie wskazuje niepowodzenie przywracania pakietu, dopóki wszystkie źródła zostały sprawdzone.</span><span class="sxs-lookup"><span data-stu-id="cb364-114">NuGet does not indicate a failure to restore a package until all the sources have been checked.</span></span> <span data-ttu-id="cb364-115">W tym czasie NuGet zgłasza błąd na liście tylko ostatni źródła.</span><span class="sxs-lookup"><span data-stu-id="cb364-115">At that time, NuGet reports the failure for only the last source in the list.</span></span> <span data-ttu-id="cb364-116">Ten błąd oznacza, że pakiet nie był dostępny na *żadnych* z innych źródeł, mimo że błędy nie są wyświetlane dla każdego z tych źródeł pojedynczo.</span><span class="sxs-lookup"><span data-stu-id="cb364-116">The error implies that the package wasn't present on *any* of the other sources, even though errors are not shown for each of those sources individually.</span></span>

<span data-ttu-id="cb364-117">Przywracanie pakietu zostanie wywołany w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="cb364-117">Package restore is triggered in the following ways:</span></span>

- <span data-ttu-id="cb364-118">**DotNet CLI**: Użyj [przywracania dotnet](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) polecenia, które przywraca pakiety wymienione w pliku projektu (zobacz [PackageReference](../consume-packages/package-references-in-project-files.md)).</span><span class="sxs-lookup"><span data-stu-id="cb364-118">**dotnet CLI**: use the [dotnet restore](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) command, which restores packages listed in the project file (see [PackageReference](../consume-packages/package-references-in-project-files.md)).</span></span> <span data-ttu-id="cb364-119">.NET Core 2.0 lub nowszy, przywracania odbywają się automatycznie z `dotnet build` i `dotnet run`.</span><span class="sxs-lookup"><span data-stu-id="cb364-119">With .NET Core 2.0 and later, restore is done automatically with `dotnet build` and `dotnet run`.</span></span>

- <span data-ttu-id="cb364-120">**Interfejs użytkownika Menedżera pakietów (Visual Studio w systemie Windows)**: pakiety zostaną przywrócone automatycznie podczas tworzenia projektu z szablonu i podczas kompilowania projektu (może ulec opcja opisana w [Włączanie i wyłączanie pakietu przywrócić](#enabling-and-disabling-package-restore)).</span><span class="sxs-lookup"><span data-stu-id="cb364-120">**Package Manager UI (Visual Studio on Windows)**: Packages are restored automatically when creating a project from a template and when building a project (subject to the option described in [Enabling and disabling package restore](#enabling-and-disabling-package-restore)).</span></span> <span data-ttu-id="cb364-121">W NuGet 4.0 + przywracania również odbywa się automatycznie po wprowadzeniu zmian projekt na podstawie zestawu SDK programu .NET Core.</span><span class="sxs-lookup"><span data-stu-id="cb364-121">In NuGet 4.0+, restore also happens automatically when changes are made to a .NET Core SDK-based project.</span></span>

    <span data-ttu-id="cb364-122">Aby przywrócić ręcznie, kliknij prawym przyciskiem myszy rozwiązanie w Eksploratorze rozwiązań i wybierz **przywracania pakietów NuGet**.</span><span class="sxs-lookup"><span data-stu-id="cb364-122">To restore manually, right-click the solution in Solution Explorer and select **Restore NuGet Packages**.</span></span> <span data-ttu-id="cb364-123">Jeśli co najmniej jeden indywidualne pakiety są nadal nie jest poprawnie zainstalowany (co oznacza, że Eksplorator rozwiązań zawiera ikony błędu), a następnie użyj interfejsu użytkownika Menedżera pakietu na odinstalowanie i ponowne zainstalowanie odpowiednich pakietów.</span><span class="sxs-lookup"><span data-stu-id="cb364-123">If one or more individual packages are still not installed properly (meaning that Solution Explorer shows an error icon), then use the Package Manager UI to uninstall and reinstall the affected packages.</span></span> <span data-ttu-id="cb364-124">Zobacz [ponowne zainstalowanie i aktualizowanie pakietów](../consume-packages/reinstalling-and-updating-packages.md)</span><span class="sxs-lookup"><span data-stu-id="cb364-124">See [Reinstalling and updating packages](../consume-packages/reinstalling-and-updating-packages.md)</span></span>

    <span data-ttu-id="cb364-125">Jeśli zostanie wyświetlony błąd "ten projekt zawiera odwołania do pakietów NuGet, na tym komputerze brakuje" lub "co najmniej jednego pakietu NuGet konieczne jest przywrócenie, ale nie może być, ponieważ nie udzielono zgody", należy włączyć automatyczne przywracanie zgodnie z instrukcjami w obszarze [Włączanie i wyłączanie Przywracanie pakietu](#enabling-and-disabling-package-restore).</span><span class="sxs-lookup"><span data-stu-id="cb364-125">If you see the error "This project references NuGet package(s) that are missing on this computer" or "One or more NuGet packages need to be restored but couldn't be because consent has not been granted," turn on automatic restore by following the instructions under [Enabling and disabling package restore](#enabling-and-disabling-package-restore).</span></span>

- <span data-ttu-id="cb364-126">**Interfejs wiersza polecenia NuGet**: Użyj [Przywracanie nuget](../tools/cli-ref-restore.md) polecenia, które przywraca pakiety wymienione w pliku projektu (zobacz [PackageReference](../consume-packages/package-references-in-project-files.md)) lub w [packages.config](../reference/packages-config.md) plik.</span><span class="sxs-lookup"><span data-stu-id="cb364-126">**NuGet CLI**: use the [nuget restore](../tools/cli-ref-restore.md) command, which restores packages listed in the project file (see [PackageReference](../consume-packages/package-references-in-project-files.md)) or in a [packages.config](../reference/packages-config.md) file.</span></span> <span data-ttu-id="cb364-127">Można również określić plik rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="cb364-127">You can also specify a solution file.</span></span>

- <span data-ttu-id="cb364-128">**MSBuild**: Użyj [msbuild /t:restore](../reference/msbuild-targets.md#restore-target) poleceń, które przywraca pakietów pakiety wymienione w pliku projektu (zobacz [PackageReference](../consume-packages/package-references-in-project-files.md)).</span><span class="sxs-lookup"><span data-stu-id="cb364-128">**MSBuild**: use the [msbuild /t:restore](../reference/msbuild-targets.md#restore-target) command, which restores packages packages listed in the project file (see [PackageReference](../consume-packages/package-references-in-project-files.md)).</span></span> <span data-ttu-id="cb364-129">Dostępne tylko w NuGet 4.x+ i MSBuild 15.1 +, które są dołączone do programu Visual Studio 2017 r.</span><span class="sxs-lookup"><span data-stu-id="cb364-129">Available only in NuGet 4.x+ and MSBuild 15.1+, which are included with Visual Studio 2017.</span></span> <span data-ttu-id="cb364-130">`nuget restore` i `dotnet restore` dla projektów dotyczy zarówno Użyj tego polecenia.</span><span class="sxs-lookup"><span data-stu-id="cb364-130">`nuget restore` and `dotnet restore` both use this command for applicable projects.</span></span>

- <span data-ttu-id="cb364-131">**Visual Studio Team Services**: podczas tworzenia definicji kompilacji na Team Services, obejmują [Przywracanie NuGet](/vsts/build-release/tasks/package/nuget#restore-nuget-packages) lub [.NET Core przywrócić](/vsts/build-release/tasks/build/dotnet-core#restore-nuget-packages) zadania w definicji przed żadnego zadania kompilacji.</span><span class="sxs-lookup"><span data-stu-id="cb364-131">**Visual Studio Team Services**: When creating a build definition on Team Services, include the [NuGet restore](/vsts/build-release/tasks/package/nuget#restore-nuget-packages) or [.NET Core Restore](/vsts/build-release/tasks/build/dotnet-core#restore-nuget-packages) task in the definition before any build task.</span></span> <span data-ttu-id="cb364-132">To zadanie jest domyślnie włączone w szablony kompilacji.</span><span class="sxs-lookup"><span data-stu-id="cb364-132">This task is included by default in a number of build templates.</span></span>

- <span data-ttu-id="cb364-133">**Team Foundation Server**: TFS 2013 lub nowszym automatycznie przywraca pakietów podczas kompilacji, pod warunkiem, że używasz kompilacji szablonu Team TFS 2013 lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="cb364-133">**Team Foundation Server**: TFS 2013 and later automatically restores packages during build, provided that you're using a Team Build Template for TFS 2013 or later.</span></span> <span data-ttu-id="cb364-134">Dla wcześniejszych wersji programu TFS mogą obejmować kroku kompilacji, aby wywołać za pomocą jednego z powyższych opcji wiersza polecenia przywracania.</span><span class="sxs-lookup"><span data-stu-id="cb364-134">For earlier version of TFS, you can include a build step to invoke one of the command-line restore options above.</span></span> <span data-ttu-id="cb364-135">Opcjonalnie można przenieść szablonu kompilacji TFS 2013.</span><span class="sxs-lookup"><span data-stu-id="cb364-135">You can optionally migrate the build template to TFS 2013.</span></span> <span data-ttu-id="cb364-136">Aby uzyskać więcej informacji, zobacz [wskazówki dotyczące przywracania pakietu z Team Foundation Build](../consume-packages/team-foundation-build.md).</span><span class="sxs-lookup"><span data-stu-id="cb364-136">For more information, see the [Walkthrough of package restore with Team Foundation Build](../consume-packages/team-foundation-build.md).</span></span>

## <a name="enabling-and-disabling-package-restore"></a><span data-ttu-id="cb364-137">Włączanie i wyłączanie przywracania pakietu</span><span class="sxs-lookup"><span data-stu-id="cb364-137">Enabling and disabling package restore</span></span>

<span data-ttu-id="cb364-138">Przywracanie pakietu głównie jest włączany za pomocą **Narzędzia > Opcje > Menedżera pakietów NuGet** w programie Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="cb364-138">Package restore is primarily enabled through **Tools > Options > NuGet Package Manager** in Visual Studio:</span></span>

![Kontrolowanie zachowania przywracania pakietu za pomocą opcji Menedżera pakietów NuGet](media/Restore-01-AutoRestoreOptions.png)

- <span data-ttu-id="cb364-140">**Zezwalaj narzędziu NuGet na pobieranie brakujących pakietów**: Określa wszystkich formularzy Przywracanie pakietu, zmieniając `packageRestore/enabled` w `%AppData%\NuGet\NuGet.Config` plików, jak pokazano poniżej.</span><span class="sxs-lookup"><span data-stu-id="cb364-140">**Allow NuGet to download missing packages**: controls all forms of package restore by changing the `packageRestore/enabled` setting in the `%AppData%\NuGet\NuGet.Config` file as shown below.</span></span>

    ```xml
    <configuration>
        <packageRestore>
            <!-- The 'enabled' key is True when the "Allow NuGet to download missing packages" checkbox is set.
                 Clearing the box sets this to False, disabling command-line, automatic, and MSBuild-Integrated restore. -->
            <add key="enabled" value="True" />
        </packageRestore>
    </configuration>
    ```
    <br/>
    > [!Note]
    >  <span data-ttu-id="cb364-141">`packageRestore/enabled` Ustawienie można zastąpić globalny, ustawiając zmienną środowiskową o nazwie **EnableNuGetPackageRestore** o wartości TRUE lub FALSE przed uruchomieniem programu Visual Studio lub uruchamianie kompilacji.</span><span class="sxs-lookup"><span data-stu-id="cb364-141">The `packageRestore/enabled` setting can be overridden globally by setting an environment variable called **EnableNuGetPackageRestore** with a value of TRUE or FALSE before launching Visual Studio or starting a build.</span></span>

- <span data-ttu-id="cb364-142">**Automatyczne sprawdzenie dostępności dla brakujących pakietów podczas kompilacji w programie Visual Studio**: Określa przywracania automatycznie, zmieniając `packageRestore/automatic` w `%AppData%\NuGet\NuGet.Config` plików, jak pokazano poniżej.</span><span class="sxs-lookup"><span data-stu-id="cb364-142">**Automatically check for missing packages during build in Visual Studio**: controls automatic restore by changing the `packageRestore/automatic` setting in the `%AppData%\NuGet\NuGet.Config` file as shown below.</span></span>

    ```xml
    ...
    <configuration>
        <packageRestore>
            <!-- The 'automatic' key is set to True when the "Automatically check for missing packages during
                 build in Visual Studio" checkbox is set. Clearing the box sets this to False and disables
                 automatic restore. -->
            <add key="automatic" value="True" />
        </packageRestore>
    </configuration>
    ```

<span data-ttu-id="cb364-143">Aby informacje, zobacz [NuGet pliku konfiguracji - sekcji packageRestore](../reference/nuget-config-file.md#packagerestore-section).</span><span class="sxs-lookup"><span data-stu-id="cb364-143">For reference, see the [NuGet config file - packageRestore section](../reference/nuget-config-file.md#packagerestore-section).</span></span>

<span data-ttu-id="cb364-144">W niektórych przypadkach włączyć lub wyłączyć Przywracanie pakietów dla wszystkich użytkowników na komputerze może być deweloperem lub firmy.</span><span class="sxs-lookup"><span data-stu-id="cb364-144">In some cases, a developer or company might want to enable or disable package restore for all users on a computer.</span></span> <span data-ttu-id="cb364-145">Jest to realizowane przez dodanie tych samych ustawień powyżej do globalnych znajduje się w pliku konfiguracji w NuGet `%ProgramData%\NuGet\Config[\{IDE}[\{Version}[\{SKU}]]]`.</span><span class="sxs-lookup"><span data-stu-id="cb364-145">This is done by adding the same settings above to the global NuGet configuration file located in `%ProgramData%\NuGet\Config[\{IDE}[\{Version}[\{SKU}]]]`.</span></span> <span data-ttu-id="cb364-146">Poszczególnym użytkownikom można selektywnie włączysz przywracania na poziomie projektu.</span><span class="sxs-lookup"><span data-stu-id="cb364-146">Individual users can then selectively enable restore as needed on a project level.</span></span> <span data-ttu-id="cb364-147">Zobacz [NuGet Konfigurowanie zachowania](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied) dokładne szczegółowe informacje na temat sposobu NuGet priorytetem wiele plików konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="cb364-147">See [Configuring NuGet behavior](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied) for exact details on how NuGet prioritizes multiple config files.</span></span>

## <a name="constraining-package-versions-with-restore"></a><span data-ttu-id="cb364-148">Ograniczający wersje pakietu z przywracania</span><span class="sxs-lookup"><span data-stu-id="cb364-148">Constraining package versions with restore</span></span>

<span data-ttu-id="cb364-149">Podczas przywracania pakietów przy użyciu dowolnej metody, NuGet honoruje żadnych ograniczeń określone w `packages.config` lub pliku projektu:</span><span class="sxs-lookup"><span data-stu-id="cb364-149">When restoring packages through any method, NuGet honors any constraints specified in `packages.config` or the project file:</span></span>

- <span data-ttu-id="cb364-150">`packages.config`: Określ zakres wersji w `allowedVersion` właściwości zależności.</span><span class="sxs-lookup"><span data-stu-id="cb364-150">`packages.config`: Specify a version range in the `allowedVersion` property of the dependency.</span></span> <span data-ttu-id="cb364-151">Zobacz [ponowne zainstalowanie i aktualizowanie pakietów](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions).</span><span class="sxs-lookup"><span data-stu-id="cb364-151">See [Reinstalling and updating packages](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions).</span></span> <span data-ttu-id="cb364-152">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="cb364-152">For example:</span></span>

    ```xml
    <package id="Newtonsoft.json" version="6.0.4" allowedVersions="[6,7)" />
    ```

- <span data-ttu-id="cb364-153">PackageReference: Określ zakres wersji bezpośrednio z numerem wersji tych zależności.</span><span class="sxs-lookup"><span data-stu-id="cb364-153">PackageReference: Specify a version range directly with the dependency's version number.</span></span> <span data-ttu-id="cb364-154">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="cb364-154">For example:</span></span>

    ```xml
    <PackageReference Include="Newtonsoft.json" Version="[6, 7)" />
    ```

<span data-ttu-id="cb364-155">We wszystkich przypadkach Notacja opisanego w [wersji pakietu](../reference/package-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="cb364-155">In all cases, use the notation described in [Package versioning](../reference/package-versioning.md).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="cb364-156">Rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="cb364-156">Troubleshooting</span></span>

<span data-ttu-id="cb364-157">Zobacz [Rozwiązywanie problemów z Przywracanie pakietu](package-restore-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="cb364-157">See [Troubleshooting package restore](package-restore-troubleshooting.md).</span></span>